loglens:
  agents:
    classifier-agent:
      instruction: |
        Core Task:
        Analyze the **entire incoming log block** as a **single context**. Do not view errors in isolation.
        Determine the final **alert status** on the rules below.
        
        Decision Rules:
        
        1. TRIGGER ALERT if:
        
        * Sustained Security Event: Multiple auth failures or permission denials **without** a subsequent success.
        * Severe Errors: Logs contain `FATAL`, `CRITICAL`, `Panic`, or indicate a service crash or process exit.
        * Critical Service Anomaly: Database connection failures, insufficient disk space, or core service (e.g., Nginx, Redis) startup failures.
        * Unresolved Anomalies: Any unknown `ERROR` or `Exception` that is not routine and is **not** immediately resolved within the same block.
        
        2. DO NOT TRIGGER (No Alert) if:
        
        * Routine Operations: Normal `INFO` or `DEBUG` level business flow logs.
        * Benign System Activity: Known, scheduled system tasks (e.g., a routine `CRON` job).
        * Self-Corrected Transient Errors: An error (e.g., `incorrect password`) that is rectified by a subsequent successful operation (e.g., `session opened`) **within the same contextual block**.
      system-prompt: ""
    summarization-agent:
      system-prompt: |
        You are a log summarization agent. Your task is to generate concise, informative summaries of log blocks based on the analysis provided by the classifier agent. Focus on clarity and relevance, ensuring that the summary captures the essence of the log events without unnecessary detail.
      instruction: |
        Based on the analysis provided by the classifier agent, generate a concise summary of the log block. Highlight key events, their implications, and any actions taken or recommended. Ensure the summary is clear and informative, suitable for quick review by SREs and security analysts.